# ３層アーキテクチャ

## データアクセス層（Gateway, Modelなど）
- DBとやり取りを行う
- DBからデータを取得する処理を記述
- 戻り値は各テーブルのレコードのインスタンスを返却するようにする
  - ロジックを持たないデータクラスを作成し、データクラスのインスタンスを返却
  - getterのみ持っているクラス
  - エンティティということもある

## プレゼンテーション層（Router, Controller, Presenterなど）
- ルーティングやコントローラーに該当する
- リクエストを受けたりレスポンスを変返す責務のみ負う（システム利用者とのやりとり）
- DTOを定義したりする
  - データの入れ物クラスのこと
やりとり
## アプリケーション層（Service, UseCaseなど）
- 実際のアプリケーションのロジックを記述する

# ビジネスロジックとは
- データアクセス（DBとのやりとり）とプレゼンテーション（ユーザーとの）以外の部分
## これはビジネスロジックなのか？
### 日付形式の変換はビジネスロジックか？（GMT -> 2024/01/01とか）
- 見た目を変えるだけなのでプレゼンテーション層の役割かも（日付変換のアプリだったらビジネスロジックかも）

### リクエストの形式チェックはビジネスロジックか？
- プレゼンテーション層でチェックするのがいいかも
- UIなどユーザーととインターフェースに関することに関心を持つべきだから
- 不正な値は早めにエラーを返して、先に（ロジックやサービス）進めないようにしたい

## ドメインロジックとユースケース
**システムなしでも現実世界で同じことをやろうとした時にと出てくるルールはドメインロジック**

- ゲームでも物理的なリバーシでも紙とペンなど何でやっても普遍のルール

### ドメインロジックとは
リバーシだと
- 石を置けるかチェック
- 石を置く
- 石ひっくり返す
- 石の配置を保存する
など1つ1つの処理でリバーシのコアなルールのこと（ビジネスルールともいう）

### ユースケースとは
上記の一連の流れをユースケースという

### リポジトリパターン（Repository）
- サービスクラスからドメインを個別に参照すると、サービスのコードが多くなってしまう
- ドメインモデルのまとまったデータを処理（turnのレコードをmoveGatewayクラスメソッドの引数に渡すなど）をまとめることでコードの肥大化を防ぐ目的がある

